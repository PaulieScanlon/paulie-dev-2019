---
title: MDX Embed
tags: ["MDX", "Gatsby", "React", "npm"]
date: 2020-09-16
author: Paul Scanlon
featuredImageUrl: https://res.cloudinary.com/www-paulie-dev/image/upload/v1599061021/paulie.dev/2020/09/mdx-embed_hcwy0p.jpg
---

Ahoy [MDX](https://mdxjs.com/) fans üõ≥Ô∏è if you're reading this i'll assume you've already experienced how absolutely mind blowing MDX is, and if not then watch this [video](https://youtu.be/-xusVshCZ3M) by the fantastic [Prince Wilson](https://twitter.com/maxcell)

I first fell in love with MDX in 2019 and have been experimenting with it ever since and in January of this year as part of my [#100DaysOfGatsby](https://paulie.dev/posts/2020/01/100DaysOfGatsby/) mega commitment to post every day for 100 days I created [gatsby-mdx-embed](https://github.com/PaulieScanlon/gatsby-mdx-embed)

> gatsby-mdx-embed is a Gatsby MDX plugin to embed Twitter, YouTube, Instagram and many more into your .mdx without import.

Like me you've probably encountered markdown embed plugins before but it was some time before i noticed the flaws some of these plugins have, allow me to explain myself.

A markdown plugin will typically require you add a URL to your post like this one for CodePen üëá

```javascript
# Lorem ipsum

Suspendisse orci metus, tempus ut rutrum non, eleifend sed sapien.

https://codepen.io/team/codepen/pen/PNaGbb

```

...and this will indeed recognize `/codepen.io/...`, execute the code which in turn loads a CodePen iframe.

However, what you might not have noticed is that regardless of where in the page this embed code lives, be it near the top where a user can see it or, [below the fold](https://www.optimizely.com/uk/optimization-glossary/below-the-fold/) where a user would have to scroll to see it, additional HTML, CSS and Javascript is loaded into the page in order for the CodePen to display correctly.

All this additional "code" can lead to poorly performing page load speeds and lighthouse scores and naturally this problem is exaggerated the more embeds you have on each page.

MDX Embed differs somewhat to this approach of _"f\*\*k it, load it"_ and instead attempts to apply the _"would you mind awfully if I were to load myself please"_ approach. In a manner of speaking MDX Embed is very polite.

This is possible thanks to MDX Embeds' use of the [Intersection Observer](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API) and right at the heart of MDX Embed, wrapped around every component is what we call the **"General Observer"**

When General Observer _reports for duty_, or in other words when a component enters the viewport then **and** only then does it attempt to load the 3rd party embed script. This is key to ensuring additional "code" is **only** loaded as and when required. This method can help keep page load speeds fast and lighthouse scores high.

### Then

Over the course of the 100 days challenge I released a few updates to the project and had some really positive initial feedback which was fab, [gatsby-mdx-embed](https://github.com/PaulieScanlon/gatsby-mdx-embed) was just one of the [10 challenges](https://www.gatsbyjs.com/blog/2020-04-20-paulie-scanlons-journey-of-100-days/) I self-set myself and I was pleased at least one of these experiments was looking like it might have legs. On that note Gatsby's own [Laurie Barth](https://twitter.com/laurieontech) was actually one of the projects earliest adopters... Thanks Laurie üíú your support is very much appreciated!

Over time however my interest in the project waned, I wasn't happy with repo structure or docs site and was eagerly awaiting [Storybook](https://storybook.js.org/) `6.0.0` which is now out of alpha and by the way is brilliant and I'd become a little deflated by the lack of interest in the project. I imagine for lots of open source developers this happens so if you are using someone elses project please do make a note of Tweeting about it and showing your support by adding a Star to the repo. They're only small things but trust me they can a world of difference.

Wth that said [Scott Spence](https://twitter.com/spences10) has been instrumental in keeping me upbeat and keeping the project alive and has contributed a number of times and generally just been a positive influence on both myself and the project. Thanks Scott! üíú

### Now

As an MDX enthusiast I was naturally pretty excited by the announcement of the first ever [MDX Conf](https://mdxjs.com/conf/) organized by [Chris Biscardi](https://twitter.com/chrisbiscardi), and when I tuned in I couldn't believe what I was seeing, both [Monica Powell](https://twitter.com/waterproofheart) and [Kathleen McMahon](https://twitter.com/resource11) were talking about and using `gatsby-mdx-embed`... I then ruined it by making a joke meant for Scott but forgot it was a live stream, apologies again Kathleen! üò¨

... anyway, following on from MDX Conf Monica tweeted the following:

> With gatsby-mdx-embed you can embed all kinds things in MDX like Codepens, CodeSandboxes, tweets and even Egghead lessons! Don't let the name fool you...it can be used outside of Gatsby - @waterproofheart

Monica is absolutely right, `gatsby-mdx-embed` can and always has been able to work outside of Gatsby, I just hadn't done a very good job of calling it out in the README. From here both [Scott Spence](https://twitter.com/spences10) and [Rich Haines](https://twitter.com/studio_hungry) offered up frequent but friendly encouragement for me to do something about that.

Rich has been doing quite a bit of work in and around the [Next.js](https://nextjs.org/) / [next-mdx](https://github.com/vercel/next.js/tree/canary/packages/next-mdx) projects and has played a prominent role in encouraging MDX Embeds' usage outside of Gatsby. Thanks Rich üíú

I'm really pleased to now have both Rich and Scott as part of the core contributors team, and if either of you are reading this. Thank you again!

So the decision was made. MDX Embed needs to move, and as of Friday 28th of August 2020 I archived `gatsby-mdx-embed` and set about creating an new [monorepo](https://github.com/PaulieScanlon/mdx-embed) which I hope will be much for developer friendly and pleasant to maintain and contribute to.

### Back with a bang

I'm now pleased to introduce the new home of MDX Embed: [https://mdx-embed.com](https://mdx-embed.com) complete with a snazzy new logo designed by [Griko Nibras](https://twitter.com/griko_nibras)

The new docs site which uses the latest version of [Storybook](https://storybook.js.org/) is home to documentation on how to use the components plus help snippets to aid users in finding embed codes from various providers and a few examples of where and how MDX Embed can be used in other projects and frameworks.

### Fear ye not

Gatsby plugin support remains but is now it's own package called `gatsby-plugin-mdx-embed` which is really just a child component returned by Gatsbys' `wrapRootElement` and has a dependency on the core package `mdx-embed`

Thanks to the Gatsby plugin eco-system to get started with MDX Embed all you really need to do is install the dependencies

```sh
npm install mdx-embed gatsby-plugin-mdx-embed --save
```

<Divider />

add `gatsby-plugin-mdx-embed` to the `gatsby.config.js` plugins array.

```javascript

// gatsby-config.js
module.exports = {
  ...
  plugins: [`gatsby-plugin-mdx-embed`]
  ...
}
```

<Divider />

### Alternatively

If you experience any issues with the plugin you can manually add the `MDXEmbedProvider` to your own `gatsby-browser.js` and / or `gatsby-ssr.js` files and return it from `wrapRootElement`

```javascript
// gatsby-browser.js || gatsby-ssr.js
import React from "react"
import { MDXEmbedProvider } from "mdx-embed"

export const wrapRootElement = ({ element }) => {
  return <MDXEmbedProvider>{element}</MDXEmbedProvider>
}
```

### Or

If you're only interested in using one or two of the components in MDX Embed you can import and use them by passing them on to your own MDXProvider.

```javascript
import React from "react"
import { MDXProvider } from "@mdx-js/react"
import { CodePen, Gist } from "mdx-embed"

const components = {
  CodePen,
  Gist,
}

export default (props) => (
  <MDXProvider components={components}>{props.children}</MDXProvider>
)
```

<Divider />

### Furthermore

You could also manually import each component in to a single `.mdx` file and avoid the _provider_ install all together

```javascript
// some-mdx-file.mdx
---
title: Some Title
tags: ["React", "Gatsby"]
---

import { CodePen } from 'mdx-embed'

#### My cool pen

Here's a pen, and some other blog post text

<CodePen codePenId="PNaGbb" />

```

<Divider />

### Jsx

MDX Embed components will also work outside of MDX. If you're interested in using them in Jsx you can also import and use as you normally would.

```javascript
import React from "react"
import { CodePen } from "mdx-embed"

export default () => (
  <>
    <h1>Hello world</h1>
    <br />
    <h2>My Codepen</h2>
    <CodePen codePenId="PNaGbb" />
  </>
)
```

<Divider />

As you should now be able to see this restructure is more than just names for packages and represents a new direction for MDX Embed. Our ethos if you like is that MDX Embed _should_ work anywhere MDX works... + a bonus Jsx usage method as mentioned about.

We hope in the future MDX Embed will become the defacto method for Embedding 3rd party media content in MDX - no import required!

We're actively working on deploying examples to illustrate the various MDX Embed consumption methods but for now these examples can be found in the repo under [examples](https://github.com/PaulieScanlon/mdx-embed/tree/main/examples)

We currently have examples for the following:

- Gatsby
- MDX Deck
- Next MDX Deck
- Next

### We're not _quite_ stable

At the time of writing this post we've not quite reached a stable release, and for good reason... tests!

It's here where we're calling on the community for help and we've been really busy preparing the repo, creating a [CODE_OF_CONDUCT](https://github.com/PaulieScanlon/mdx-embed/blob/main/CODE_OF_CONDUCT.md) and [CONTRIBUTING](https://github.com/PaulieScanlon/mdx-embed/blob/main/CONTRIBUTING.md) document in preparation for this years [Hacktoberfest](https://hacktoberfest.digitalocean.com/)

Since re-launching the package we've already welcomed our first contributor; [Gabi](https://twitter.com/nohinder) who did a splendid job enhancing the Twitch component and was an absolute joy to collaborate with, so if you're interested in contributing to the project we have an ongoing [Umbrella Issue](https://github.com/PaulieScanlon/mdx-embed/issues/71) which _should_ be everything you need to get started, and have a browse of any open issues labeled **Hacktoberfest**.

The current plan is to ask for help in creating both Unit Tests and Integration Tests which once complete should bring us to a stable release of `1.0.0`

Oh, and if you do happen to stop by the [repo](https://github.com/PaulieScanlon/mdx-embed) a cheeky GitHub star ‚≠ê would be very much appreciated!

### The future

The bigger picture plans for MDX Embed are for the larger blogging platforms [Medium](https://medium.com/) or [dev.to](https://dev.to/) et al to adopt the project affording authors the ability to embed _all the things_ but in a way that won't affect site performance as mentioned above. If anyone reading this has any good ins with either of those sites we'd love to get the conversations going.

Perhaps one day the Gatsby blog will also adopt MDX Embed making it possible to write about a piece of code and then have an embedded CodeSandbox right there in the post.

...lastly, and this is _hot off the press_, i've had discussions with [Dominic Nguyen](https://twitter.com/domyen) at [Storybook](https://twitter.com/storybookjs) regarding an official Storybook [addon-on](https://storybook.js.org/addons/) so stay tuned for that!

...and that's it for now folks!

If you have any questions, queries or just general ponderings please do reach out to one of us and we'd be happy to help!

- Paul Scanlon | [@pauliescanlon](https://twitter.com/PaulieScanlon)
- Scott Spence | [@spences10](https://twitter.com/spences10)
- Rich Haines | [@studio_hungry](https://twitter.com/studio_hungry)
